function getOAuthRedirectProperties(){return{encodedService:$("#redirectEncodedService").val(),context:$("#redirectContext").val()}}function onGoogleAuthFailure(a){window.edap.push(function(a){a.trigger("login.failure",{loginsource:"CAS",logintype:"google"})});console.log(a)}
function onGoogleAuthSuccess(a){var b=$("#oAuthRedirectUrl").val();a=a?a.getAuthResponse().id_token:"";window.edap.push(function(a){a.trigger("login.success",{loginsource:"CAS",logintype:"google"})});b&&b.length?activateTraveler(b,"GOOGLE",a):registerTraveler("GOOGLE",a)}
function onGoogleApiLoad(){var a;gapi.load("auth2",function(){a=gapi.auth2.init();$(".google-button").click(function(b){b.preventDefault();window.edap.push(function(a){a.trigger("login.attempt",{loginsource:"CAS",logintype:"google"})});a.isSignedIn.get()?onGoogleAuthSuccess(a.currentUser.get()):a.signIn({scope:"https://www.googleapis.com/auth/plus.login"}).then(onGoogleAuthSuccess,onGoogleAuthFailure);window.edap.push(function(a){a.trigger("generic.modal",{modalaction:"open",modalname:"google"})})})},
onGoogleAuthFailure)}function registerTraveler(a,b){var c=getOAuthRedirectProperties();window.location="/auth/traveler/register?"+$.param({oAuthType:a,token:encodeURIComponent(b),service:c.encodedService,context:encodeURIComponent(c.context)})}
function activateTraveler(a,b,c){var d=getOAuthRedirectProperties();a=a+(0>a.indexOf("?")?"?":"\x26")+$.param({token:encodeURIComponent(c)});$('\x3cform action\x3d"'+a+'" method\x3d"post"\x3e\x3cinput name\x3d"oAuthType" value\x3d"'+b+'"/\x3e\x3cinput name\x3d"token" value\x3d"'+encodeURIComponent(c)+'"/\x3e\x3cinput name\x3d"target" value\x3d"'+d.encodedService+'"/\x3e\x3cinput name\x3d"context" value\x3d"'+encodeURIComponent(d.context)+'"/\x3e\x3c/form\x3e').appendTo("body").submit().remove()}
function doFacebookLogin(){window.edap.push(function(a){a.trigger("login.attempt",{loginsource:"CAS",logintype:"facebook"})});var a=$("#oAuthRedirectUrl").val(),b;FB.login(function(c){c.authResponse?(window.edap.push(function(a){a.trigger("login.success",{loginsource:"CAS",logintype:"facebook"})}),FB.api("/me",function(d){b=c.authResponse.accessToken;a&&a.length?activateTraveler(a,"FACEBOOK",b):registerTraveler("FACEBOOK",b)})):(window.edap.push(function(a){a.trigger("login.failure",{loginsource:"CAS",
logintype:"facebook"})}),console.log("User cancelled login or did not fully authorize."),window.edap.push(function(a){a.trigger("generic.modal",{modalaction:"close",modalname:"facebook"})}))},{scope:"email",auth_type:"rerequest"})}
$(document).ready(function(){"undefined"!=typeof Social&&(Social.SETTINGS.fbLocale=UMS.locale,Social.initForHost());$(".fb-button").click(function(a){a.preventDefault();a=$('\x3cdiv id\x3d"status" class\x3d"ui-state-error ui-corner-all"/\x3e');var b=$("#messages")||{},c=$("#registerCheckbox")||{},d=$("#acceptedTermsAndConditions")||{};1==c.length&&"checked"!=d.attr("checked")?(a.html(UMS.tcErrorMessage),b.html(a)):doFacebookLogin();window.edap.push(function(a){a.trigger("generic.modal",{modalaction:"open",
modalname:"facebook"})})})});
//# sourceMappingURL=../06/DADB97DD582D2E8087290BF05A2B40-travelerOAuth.js.map